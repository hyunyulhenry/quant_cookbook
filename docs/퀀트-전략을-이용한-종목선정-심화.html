<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 퀀트 전략을 이용한 종목선정 (심화) | R을 이용한 퀀트 투자 포트폴리오 만들기</title>
  <meta name="description" content="Chapter 10 퀀트 전략을 이용한 종목선정 (심화) | R을 이용한 퀀트 투자 포트폴리오 만들기" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 퀀트 전략을 이용한 종목선정 (심화) | R을 이용한 퀀트 투자 포트폴리오 만들기" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="hyunyulhenry/quant_cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 퀀트 전략을 이용한 종목선정 (심화) | R을 이용한 퀀트 투자 포트폴리오 만들기" />
  
  
  

<meta name="author" content="이현열" />


<meta name="date" content="2021-01-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="퀀트-전략을-이용한-종목선정-기본.html"/>
<link rel="next" href="포트폴리오-구성.html"/>
<script src="libs/jquery-3.5.0/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-8.1.2/highcharts.js"></script>
<script src="libs/highcharts-8.1.2/highcharts-3d.js"></script>
<script src="libs/highcharts-8.1.2/highcharts-more.js"></script>
<script src="libs/highcharts-8.1.2/modules/stock.js"></script>
<script src="libs/highcharts-8.1.2/modules/map.js"></script>
<script src="libs/highcharts-8.1.2/modules/annotations.js"></script>
<script src="libs/highcharts-8.1.2/modules/data.js"></script>
<script src="libs/highcharts-8.1.2/modules/drilldown.js"></script>
<script src="libs/highcharts-8.1.2/modules/item-series.js"></script>
<script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script>
<script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-8.1.2/modules/exporting.js"></script>
<script src="libs/highcharts-8.1.2/modules/export-data.js"></script>
<script src="libs/highcharts-8.1.2/modules/funnel.js"></script>
<script src="libs/highcharts-8.1.2/modules/heatmap.js"></script>
<script src="libs/highcharts-8.1.2/modules/treemap.js"></script>
<script src="libs/highcharts-8.1.2/modules/sankey.js"></script>
<script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script>
<script src="libs/highcharts-8.1.2/modules/organization.js"></script>
<script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script>
<script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script>
<script src="libs/highcharts-8.1.2/modules/sunburst.js"></script>
<script src="libs/highcharts-8.1.2/modules/vector.js"></script>
<script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script>
<script src="libs/highcharts-8.1.2/modules/xrange.js"></script>
<script src="libs/highcharts-8.1.2/modules/tilemap.js"></script>
<script src="libs/highcharts-8.1.2/modules/venn.js"></script>
<script src="libs/highcharts-8.1.2/modules/gantt.js"></script>
<script src="libs/highcharts-8.1.2/modules/timeline.js"></script>
<script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-8.1.2/modules/bullet.js"></script>
<script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script>
<script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script>
<script src="libs/highcharts-8.1.2/modules/lollipop.js"></script>
<script src="libs/highcharts-8.1.2/modules/series-label.js"></script>
<script src="libs/highcharts-8.1.2/plugins/motion.js"></script>
<script src="libs/highcharts-8.1.2/custom/reset.js"></script>
<script src="libs/highcharts-8.1.2/modules/boost.js"></script>
<script src="libs/highchart-binding-0.8.2/highchart.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R을 이용한 퀀트 투자 포트폴리오 만들기</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#지은이-소개"><i class="fa fa-check"></i>지은이 소개</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#머리말"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#이-책의-구성"><i class="fa fa-check"></i>이 책의 구성</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#이-책에서-다루지-않은-주제"><i class="fa fa-check"></i>이 책에서 다루지 않은 주제</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#도움이-될-만한-자료들"><i class="fa fa-check"></i>도움이 될 만한 자료들</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#이-책의-지원-페이지"><i class="fa fa-check"></i>이 책의 지원 페이지</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#종목과-관련된-유의사항"><i class="fa fa-check"></i>종목과 관련된 유의사항</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#세션정보"><i class="fa fa-check"></i>세션정보</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html"><i class="fa fa-check"></i><b>1</b> 퀀트 투자의 심장: 데이터와 프로그래밍</a><ul>
<li class="chapter" data-level="1.1" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html#데이터-구하기"><i class="fa fa-check"></i><b>1.1</b> 데이터 구하기</a></li>
<li class="chapter" data-level="1.2" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html#퀀트-투자와-프로그래밍"><i class="fa fa-check"></i><b>1.2</b> 퀀트 투자와 프로그래밍</a></li>
<li class="chapter" data-level="1.3" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html#r-프로그램"><i class="fa fa-check"></i><b>1.3</b> R 프로그램</a></li>
<li class="chapter" data-level="1.4" data-path="퀀트-투자의-심장-데이터와-프로그래밍.html"><a href="퀀트-투자의-심장-데이터와-프로그래밍.html#퀀트-투자에-유용한-r-패키지"><i class="fa fa-check"></i><b>1.4</b> 퀀트 투자에 유용한 R 패키지</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html"><i class="fa fa-check"></i><b>2</b> 크롤링을 위한 기본 지식</a><ul>
<li class="chapter" data-level="2.1" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#인코딩의-이해와-r에서-utf-8-설정하기"><i class="fa fa-check"></i><b>2.1</b> 인코딩의 이해와 R에서 UTF-8 설정하기</a><ul>
<li class="chapter" data-level="2.1.1" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#인간과-컴퓨터-간-번역의-시작-ascii"><i class="fa fa-check"></i><b>2.1.1</b> 인간과 컴퓨터 간 번역의 시작, ASCII</a></li>
<li class="chapter" data-level="2.1.2" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#한글-인코딩-방식의-종류"><i class="fa fa-check"></i><b>2.1.2</b> 한글 인코딩 방식의 종류</a></li>
<li class="chapter" data-level="2.1.3" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#r에서-utf-8-설정하기"><i class="fa fa-check"></i><b>2.1.3</b> R에서 UTF-8 설정하기</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#웹의-동작-방식"><i class="fa fa-check"></i><b>2.2</b> 웹의 동작 방식</a><ul>
<li class="chapter" data-level="2.2.1" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#http"><i class="fa fa-check"></i><b>2.2.1</b> HTTP</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#html과-css"><i class="fa fa-check"></i><b>2.3</b> HTML과 CSS</a><ul>
<li class="chapter" data-level="2.3.1" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#html-기본-구조"><i class="fa fa-check"></i><b>2.3.1</b> HTML 기본 구조</a></li>
<li class="chapter" data-level="2.3.2" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#태그와-속성"><i class="fa fa-check"></i><b>2.3.2</b> 태그와 속성</a></li>
<li class="chapter" data-level="2.3.3" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#h-태그와-p-태그"><i class="fa fa-check"></i><b>2.3.3</b> h 태그와 p 태그</a></li>
<li class="chapter" data-level="2.3.4" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#리스트를-나타내는-ul-태그와-ol-태그"><i class="fa fa-check"></i><b>2.3.4</b> 리스트를 나타내는 ul 태그와 ol 태그</a></li>
<li class="chapter" data-level="2.3.5" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#table-태그"><i class="fa fa-check"></i><b>2.3.5</b> table 태그</a></li>
<li class="chapter" data-level="2.3.6" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#a-태그와-src-태그-및-속성"><i class="fa fa-check"></i><b>2.3.6</b> a 태그와 src 태그 및 속성</a></li>
<li class="chapter" data-level="2.3.7" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#div-태그"><i class="fa fa-check"></i><b>2.3.7</b> div 태그</a></li>
<li class="chapter" data-level="2.3.8" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#css"><i class="fa fa-check"></i><b>2.3.8</b> CSS</a></li>
<li class="chapter" data-level="2.3.9" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#클래스와-id"><i class="fa fa-check"></i><b>2.3.9</b> 클래스와 id</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#파이프-오퍼레이터"><i class="fa fa-check"></i><b>2.4</b> 파이프 오퍼레이터(<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="2.5" data-path="크롤링을-위한-기본-지식.html"><a href="크롤링을-위한-기본-지식.html#오류에-대한-예외처리"><i class="fa fa-check"></i><b>2.5</b> 오류에 대한 예외처리</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html"><i class="fa fa-check"></i><b>3</b> API를 이용한 데이터 수집</a><ul>
<li class="chapter" data-level="3.1" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#api를-이용한-quandl-데이터-다운로드"><i class="fa fa-check"></i><b>3.1</b> API를 이용한 Quandl 데이터 다운로드</a></li>
<li class="chapter" data-level="3.2" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#getsymbols-함수를-이용한-api-다운로드"><i class="fa fa-check"></i><b>3.2</b> <code>getSymbols()</code> 함수를 이용한 API 다운로드</a><ul>
<li class="chapter" data-level="3.2.1" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#주가-다운로드"><i class="fa fa-check"></i><b>3.2.1</b> 주가 다운로드</a></li>
<li class="chapter" data-level="3.2.2" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#국내-종목-주가-다운로드"><i class="fa fa-check"></i><b>3.2.2</b> 국내 종목 주가 다운로드</a></li>
<li class="chapter" data-level="3.2.3" data-path="api를-이용한-데이터-수집.html"><a href="api를-이용한-데이터-수집.html#fred-데이터-다운로드"><i class="fa fa-check"></i><b>3.2.3</b> FRED 데이터 다운로드</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html"><i class="fa fa-check"></i><b>4</b> 크롤링 이해하기</a><ul>
<li class="chapter" data-level="4.1" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#get과-post-방식-이해하기"><i class="fa fa-check"></i><b>4.1</b> GET과 POST 방식 이해하기</a><ul>
<li class="chapter" data-level="4.1.1" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#get-방식"><i class="fa fa-check"></i><b>4.1.1</b> GET 방식</a></li>
<li class="chapter" data-level="4.1.2" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#post-방식"><i class="fa fa-check"></i><b>4.1.2</b> POST 방식</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#크롤링-예제"><i class="fa fa-check"></i><b>4.2</b> 크롤링 예제</a><ul>
<li class="chapter" data-level="4.2.1" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#금융-속보-크롤링"><i class="fa fa-check"></i><b>4.2.1</b> 금융 속보 크롤링</a></li>
<li class="chapter" data-level="4.2.2" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#기업공시채널에서-오늘의-공시-불러오기"><i class="fa fa-check"></i><b>4.2.2</b> 기업공시채널에서 오늘의 공시 불러오기</a></li>
<li class="chapter" data-level="4.2.3" data-path="크롤링-이해하기.html"><a href="크롤링-이해하기.html#네이버-금융에서-주식티커-크롤링"><i class="fa fa-check"></i><b>4.2.3</b> 네이버 금융에서 주식티커 크롤링</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html"><i class="fa fa-check"></i><b>5</b> 금융 데이터 수집하기 (기본)</a><ul>
<li class="chapter" data-level="5.1" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#한국거래소의-산업별-현황-및-개별지표-크롤링"><i class="fa fa-check"></i><b>5.1</b> 한국거래소의 산업별 현황 및 개별지표 크롤링</a><ul>
<li class="chapter" data-level="5.1.1" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#업종분류-현황-크롤링"><i class="fa fa-check"></i><b>5.1.1</b> 업종분류 현황 크롤링</a></li>
<li class="chapter" data-level="5.1.2" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#개별종목-지표-크롤링"><i class="fa fa-check"></i><b>5.1.2</b> 개별종목 지표 크롤링</a></li>
<li class="chapter" data-level="5.1.3" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#최근-영업일-기준-데이터-받기"><i class="fa fa-check"></i><b>5.1.3</b> 최근 영업일 기준 데이터 받기</a></li>
<li class="chapter" data-level="5.1.4" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#거래소-데이터-정리하기"><i class="fa fa-check"></i><b>5.1.4</b> 거래소 데이터 정리하기</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="금융-데이터-수집하기-기본.html"><a href="금융-데이터-수집하기-기본.html#wics-기준-섹터정보-크롤링"><i class="fa fa-check"></i><b>5.2</b> WICS 기준 섹터정보 크롤링</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html"><i class="fa fa-check"></i><b>6</b> 금융 데이터 수집하기 (심화)</a><ul>
<li class="chapter" data-level="6.1" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#수정주가-크롤링"><i class="fa fa-check"></i><b>6.1</b> 수정주가 크롤링</a><ul>
<li class="chapter" data-level="6.1.1" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#개별종목-주가-크롤링"><i class="fa fa-check"></i><b>6.1.1</b> 개별종목 주가 크롤링</a></li>
<li class="chapter" data-level="6.1.2" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#전-종목-주가-크롤링"><i class="fa fa-check"></i><b>6.1.2</b> 전 종목 주가 크롤링</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#재무제표-및-가치지표-크롤링"><i class="fa fa-check"></i><b>6.2</b> 재무제표 및 가치지표 크롤링</a><ul>
<li class="chapter" data-level="6.2.1" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#재무제표-다운로드"><i class="fa fa-check"></i><b>6.2.1</b> 재무제표 다운로드</a></li>
<li class="chapter" data-level="6.2.2" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#가치지표-계산하기"><i class="fa fa-check"></i><b>6.2.2</b> 가치지표 계산하기</a></li>
<li class="chapter" data-level="6.2.3" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#전-종목-재무제표-및-가치지표-다운로드"><i class="fa fa-check"></i><b>6.2.3</b> 전 종목 재무제표 및 가치지표 다운로드</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#dart의-open-api를-이용한-데이터-수집하기"><i class="fa fa-check"></i><b>6.3</b> DART의 Open API를 이용한 데이터 수집하기</a><ul>
<li class="chapter" data-level="6.3.1" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#api-key발급-및-추가하기"><i class="fa fa-check"></i><b>6.3.1</b> API Key발급 및 추가하기</a></li>
<li class="chapter" data-level="6.3.2" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#고유번호-다운로드"><i class="fa fa-check"></i><b>6.3.2</b> 고유번호 다운로드</a></li>
<li class="chapter" data-level="6.3.3" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#공시검색"><i class="fa fa-check"></i><b>6.3.3</b> 공시검색</a></li>
<li class="chapter" data-level="6.3.4" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#사업보고서-주요-정보"><i class="fa fa-check"></i><b>6.3.4</b> 사업보고서 주요 정보</a></li>
<li class="chapter" data-level="6.3.5" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#상장기업-재무정보"><i class="fa fa-check"></i><b>6.3.5</b> 상장기업 재무정보</a></li>
<li class="chapter" data-level="6.3.6" data-path="금융-데이터-수집하기-심화.html"><a href="금융-데이터-수집하기-심화.html#단일회사-전체-재무제표"><i class="fa fa-check"></i><b>6.3.6</b> 단일회사 전체 재무제표</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="데이터-정리하기.html"><a href="데이터-정리하기.html"><i class="fa fa-check"></i><b>7</b> 데이터 정리하기</a><ul>
<li class="chapter" data-level="7.1" data-path="데이터-정리하기.html"><a href="데이터-정리하기.html#주가-정리하기"><i class="fa fa-check"></i><b>7.1</b> 주가 정리하기</a></li>
<li class="chapter" data-level="7.2" data-path="데이터-정리하기.html"><a href="데이터-정리하기.html#재무제표-정리하기"><i class="fa fa-check"></i><b>7.2</b> 재무제표 정리하기</a></li>
<li class="chapter" data-level="7.3" data-path="데이터-정리하기.html"><a href="데이터-정리하기.html#가치지표-정리하기"><i class="fa fa-check"></i><b>7.3</b> 가치지표 정리하기</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html"><i class="fa fa-check"></i><b>8</b> 데이터 분석 및 시각화하기</a><ul>
<li class="chapter" data-level="8.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#종목정보-데이터-분석"><i class="fa fa-check"></i><b>8.1</b> 종목정보 데이터 분석</a><ul>
<li class="chapter" data-level="8.1.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#join-데이터-합치기"><i class="fa fa-check"></i><b>8.1.1</b> <code>*_join</code>: 데이터 합치기</a></li>
<li class="chapter" data-level="8.1.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#glimpse-데이터-구조-확인하기"><i class="fa fa-check"></i><b>8.1.2</b> <code>glimpse()</code>: 데이터 구조 확인하기</a></li>
<li class="chapter" data-level="8.1.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#rename-열-이름-바꾸기"><i class="fa fa-check"></i><b>8.1.3</b> <code>rename()</code>: 열 이름 바꾸기</a></li>
<li class="chapter" data-level="8.1.4" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#distinct-고유한-값-확인"><i class="fa fa-check"></i><b>8.1.4</b> distinct(): 고유한 값 확인</a></li>
<li class="chapter" data-level="8.1.5" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#select-원하는-열만-선택"><i class="fa fa-check"></i><b>8.1.5</b> <code>select()</code>: 원하는 열만 선택</a></li>
<li class="chapter" data-level="8.1.6" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#mutate-열-생성-및-데이터-변형"><i class="fa fa-check"></i><b>8.1.6</b> <code>mutate()</code>: 열 생성 및 데이터 변형</a></li>
<li class="chapter" data-level="8.1.7" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#filter-조건을-충족하는-행-선택"><i class="fa fa-check"></i><b>8.1.7</b> <code>filter()</code>: 조건을 충족하는 행 선택</a></li>
<li class="chapter" data-level="8.1.8" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#summarize-요약-통곗값-계산"><i class="fa fa-check"></i><b>8.1.8</b> <code>summarize()</code>: 요약 통곗값 계산</a></li>
<li class="chapter" data-level="8.1.9" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#arrange-데이터-정렬"><i class="fa fa-check"></i><b>8.1.9</b> <code>arrange()</code>: 데이터 정렬</a></li>
<li class="chapter" data-level="8.1.10" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#row_number-순위-계산"><i class="fa fa-check"></i><b>8.1.10</b> <code>row_number()</code>: 순위 계산</a></li>
<li class="chapter" data-level="8.1.11" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#ntile-분위수-계산"><i class="fa fa-check"></i><b>8.1.11</b> <code>ntile()</code>: 분위수 계산</a></li>
<li class="chapter" data-level="8.1.12" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#group_by-그룹별로-데이터를-묶기"><i class="fa fa-check"></i><b>8.1.12</b> <code>group_by()</code>: 그룹별로 데이터를 묶기</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#ggplot-기초"><i class="fa fa-check"></i><b>8.2</b> <code>ggplot()</code> 기초</a><ul>
<li class="chapter" data-level="8.2.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#diamonds-데이터셋"><i class="fa fa-check"></i><b>8.2.1</b> diamonds 데이터셋</a></li>
<li class="chapter" data-level="8.2.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#data-aesthetics-geometrics"><i class="fa fa-check"></i><b>8.2.2</b> Data, Aesthetics, Geometrics</a></li>
<li class="chapter" data-level="8.2.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#facets"><i class="fa fa-check"></i><b>8.2.3</b> Facets</a></li>
<li class="chapter" data-level="8.2.4" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#statistics"><i class="fa fa-check"></i><b>8.2.4</b> Statistics</a></li>
<li class="chapter" data-level="8.2.5" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#coordinates"><i class="fa fa-check"></i><b>8.2.5</b> Coordinates</a></li>
<li class="chapter" data-level="8.2.6" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#theme"><i class="fa fa-check"></i><b>8.2.6</b> Theme</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#종목정보-시각화"><i class="fa fa-check"></i><b>8.3</b> 종목정보 시각화</a><ul>
<li class="chapter" data-level="8.3.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#geom_point-산점도-나타내기"><i class="fa fa-check"></i><b>8.3.1</b> <code>geom_point()</code>: 산점도 나타내기</a></li>
<li class="chapter" data-level="8.3.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#geom_histogram-히스토그램-나타내기"><i class="fa fa-check"></i><b>8.3.2</b> <code>geom_histogram()</code>: 히스토그램 나타내기</a></li>
<li class="chapter" data-level="8.3.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#geom_boxplot-박스-플롯-나타내기"><i class="fa fa-check"></i><b>8.3.3</b> <code>geom_boxplot()</code>: 박스 플롯 나타내기</a></li>
<li class="chapter" data-level="8.3.4" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#dplyr과-ggplot을-연결하여-사용하기"><i class="fa fa-check"></i><b>8.3.4</b> <code>dplyr</code>과 <code>ggplot</code>을 연결하여 사용하기</a></li>
<li class="chapter" data-level="8.3.5" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#geom_bar-막대-그래프-나타내기"><i class="fa fa-check"></i><b>8.3.5</b> <code>geom_bar()</code>: 막대 그래프 나타내기</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#주가-및-수익률-시각화"><i class="fa fa-check"></i><b>8.4</b> 주가 및 수익률 시각화</a><ul>
<li class="chapter" data-level="8.4.1" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#주가-그래프-나타내기"><i class="fa fa-check"></i><b>8.4.1</b> 주가 그래프 나타내기</a></li>
<li class="chapter" data-level="8.4.2" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#인터랙티브-그래프-나타내기"><i class="fa fa-check"></i><b>8.4.2</b> 인터랙티브 그래프 나타내기</a></li>
<li class="chapter" data-level="8.4.3" data-path="데이터-분석-및-시각화하기.html"><a href="데이터-분석-및-시각화하기.html#연도별-수익률-나타내기"><i class="fa fa-check"></i><b>8.4.3</b> 연도별 수익률 나타내기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html"><i class="fa fa-check"></i><b>9</b> 퀀트 전략을 이용한 종목선정 (기본)</a><ul>
<li class="chapter" data-level="9.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#베타-이해하기"><i class="fa fa-check"></i><b>9.1</b> 베타 이해하기</a><ul>
<li class="chapter" data-level="9.1.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#베타-계산하기"><i class="fa fa-check"></i><b>9.1.1</b> 베타 계산하기</a></li>
<li class="chapter" data-level="9.1.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#베타-시각화"><i class="fa fa-check"></i><b>9.1.2</b> 베타 시각화</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#저변동성-전략"><i class="fa fa-check"></i><b>9.2</b> 저변동성 전략</a><ul>
<li class="chapter" data-level="9.2.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#저변동성-포트폴리오-구하기-일간-기준"><i class="fa fa-check"></i><b>9.2.1</b> 저변동성 포트폴리오 구하기: 일간 기준</a></li>
<li class="chapter" data-level="9.2.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#저변동성-포트폴리오-구하기-주간-기준"><i class="fa fa-check"></i><b>9.2.2</b> 저변동성 포트폴리오 구하기: 주간 기준</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#모멘텀-전략"><i class="fa fa-check"></i><b>9.3</b> 모멘텀 전략</a><ul>
<li class="chapter" data-level="9.3.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#모멘텀-포트폴리오-구하기-12개월-모멘텀"><i class="fa fa-check"></i><b>9.3.1</b> 모멘텀 포트폴리오 구하기: 12개월 모멘텀</a></li>
<li class="chapter" data-level="9.3.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#모멘텀-포트폴리오-구하기-위험조정-수익률"><i class="fa fa-check"></i><b>9.3.2</b> 모멘텀 포트폴리오 구하기: 위험조정 수익률</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#밸류-전략"><i class="fa fa-check"></i><b>9.4</b> 밸류 전략</a><ul>
<li class="chapter" data-level="9.4.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#밸류-포트폴리오-구하기-저pbr"><i class="fa fa-check"></i><b>9.4.1</b> 밸류 포트폴리오 구하기: 저PBR</a></li>
<li class="chapter" data-level="9.4.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#각-지표-결합하기"><i class="fa fa-check"></i><b>9.4.2</b> 각 지표 결합하기</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#퀄리티-전략"><i class="fa fa-check"></i><b>9.5</b> 퀄리티 전략</a><ul>
<li class="chapter" data-level="9.5.1" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#f-score"><i class="fa fa-check"></i><b>9.5.1</b> F-Score</a></li>
<li class="chapter" data-level="9.5.2" data-path="퀀트-전략을-이용한-종목선정-기본.html"><a href="퀀트-전략을-이용한-종목선정-기본.html#각-지표를-결합하기"><i class="fa fa-check"></i><b>9.5.2</b> 각 지표를 결합하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html"><i class="fa fa-check"></i><b>10</b> 퀀트 전략을 이용한 종목선정 (심화)</a><ul>
<li class="chapter" data-level="10.1" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#섹터-중립-포트폴리오"><i class="fa fa-check"></i><b>10.1</b> 섹터 중립 포트폴리오</a></li>
<li class="chapter" data-level="10.2" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#마법공식"><i class="fa fa-check"></i><b>10.2</b> 마법공식</a><ul>
<li class="chapter" data-level="10.2.1" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#퀄리티와-밸류-간의-관계"><i class="fa fa-check"></i><b>10.2.1</b> 퀄리티와 밸류 간의 관계</a></li>
<li class="chapter" data-level="10.2.2" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#마법공식-이해하기"><i class="fa fa-check"></i><b>10.2.2</b> 마법공식 이해하기</a></li>
<li class="chapter" data-level="10.2.3" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#마법공식-구성하기"><i class="fa fa-check"></i><b>10.2.3</b> 마법공식 구성하기</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#이상치-데이터-제거-및-팩터의-결합"><i class="fa fa-check"></i><b>10.3</b> 이상치 데이터 제거 및 팩터의 결합</a><ul>
<li class="chapter" data-level="10.3.1" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#트림trim-이상치-데이터-삭제"><i class="fa fa-check"></i><b>10.3.1</b> 트림(Trim): 이상치 데이터 삭제</a></li>
<li class="chapter" data-level="10.3.2" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#윈저라이징winsorizing-이상치-데이터-대체"><i class="fa fa-check"></i><b>10.3.2</b> 윈저라이징(Winsorizing): 이상치 데이터 대체</a></li>
<li class="chapter" data-level="10.3.3" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#팩터의-결합-방법"><i class="fa fa-check"></i><b>10.3.3</b> 팩터의 결합 방법</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="퀀트-전략을-이용한-종목선정-심화.html"><a href="퀀트-전략을-이용한-종목선정-심화.html#멀티팩터-포트폴리오"><i class="fa fa-check"></i><b>10.4</b> 멀티팩터 포트폴리오</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html"><i class="fa fa-check"></i><b>11</b> 포트폴리오 구성</a><ul>
<li class="chapter" data-level="11.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#최소분산-포트폴리오"><i class="fa fa-check"></i><b>11.1</b> 최소분산 포트폴리오</a><ul>
<li class="chapter" data-level="11.1.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#slsqp-함수를-이용한-최적화"><i class="fa fa-check"></i><b>11.1.1</b> <code>slsqp()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.1.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#solve.qp-함수를-이용한-최적화"><i class="fa fa-check"></i><b>11.1.2</b> <code>solve.QP()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.1.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#optimalportfolio-함수를-이용한-최적화"><i class="fa fa-check"></i><b>11.1.3</b> <code>optimalPortfolio()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.1.4" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#결괏값들의-비교"><i class="fa fa-check"></i><b>11.1.4</b> 결괏값들의 비교</a></li>
<li class="chapter" data-level="11.1.5" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#최소-및-최대-투자비중-제약조건"><i class="fa fa-check"></i><b>11.1.5</b> 최소 및 최대 투자비중 제약조건</a></li>
<li class="chapter" data-level="11.1.6" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#각-자산별-제약조건의-추가"><i class="fa fa-check"></i><b>11.1.6</b> 각 자산별 제약조건의 추가</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#최대분산효과-포트폴리오"><i class="fa fa-check"></i><b>11.2</b> 최대분산효과 포트폴리오</a><ul>
<li class="chapter" data-level="11.2.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#solve.qp-함수를-이용한-최적화-1"><i class="fa fa-check"></i><b>11.2.1</b> <code>solve.QP()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.2.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#optimalportfolio-함수를-이용한-최적화-1"><i class="fa fa-check"></i><b>11.2.2</b> <code>optimalPortfolio()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.2.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#최소-및-최대-투자비중-제약조건-1"><i class="fa fa-check"></i><b>11.2.3</b> 최소 및 최대 투자비중 제약조건</a></li>
<li class="chapter" data-level="11.2.4" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#각-자산-별-제약조건의-추가"><i class="fa fa-check"></i><b>11.2.4</b> 각 자산 별 제약조건의 추가</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#위험균형-포트폴리오"><i class="fa fa-check"></i><b>11.3</b> 위험균형 포트폴리오</a><ul>
<li class="chapter" data-level="11.3.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#주식-60와-채권-40-포트폴리오의-위험기여도"><i class="fa fa-check"></i><b>11.3.1</b> 주식 60%와 채권 40% 포트폴리오의 위험기여도</a></li>
<li class="chapter" data-level="11.3.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#rp-함수를-이용한-최적화"><i class="fa fa-check"></i><b>11.3.2</b> <code>rp()</code> 함수를 이용한 최적화</a></li>
<li class="chapter" data-level="11.3.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#위험예산-포트폴리오"><i class="fa fa-check"></i><b>11.3.3</b> 위험예산 포트폴리오</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#인덱스-포트폴리오-구성하기"><i class="fa fa-check"></i><b>11.4</b> 인덱스 포트폴리오 구성하기</a><ul>
<li class="chapter" data-level="11.4.1" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#시가총액비중-계산하기"><i class="fa fa-check"></i><b>11.4.1</b> 시가총액비중 계산하기</a></li>
<li class="chapter" data-level="11.4.2" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#인덱스-포트폴리오-복제하기"><i class="fa fa-check"></i><b>11.4.2</b> 인덱스 포트폴리오 복제하기</a></li>
<li class="chapter" data-level="11.4.3" data-path="포트폴리오-구성.html"><a href="포트폴리오-구성.html#팩터를-이용한-인핸스드-포트폴리오-구성하기"><i class="fa fa-check"></i><b>11.4.3</b> 팩터를 이용한 인핸스드 포트폴리오 구성하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html"><i class="fa fa-check"></i><b>12</b> 포트폴리오 백테스트</a><ul>
<li class="chapter" data-level="12.1" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#return.portfolio-함수"><i class="fa fa-check"></i><b>12.1</b> <code>Return.Portfolio()</code> 함수</a><ul>
<li class="chapter" data-level="12.1.1" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#인자-목록-살펴보기"><i class="fa fa-check"></i><b>12.1.1</b> 인자 목록 살펴보기</a></li>
<li class="chapter" data-level="12.1.2" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#출력값-살펴보기"><i class="fa fa-check"></i><b>12.1.2</b> 출력값 살펴보기</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#전통적인-60대-40-포트폴리오-백테스트"><i class="fa fa-check"></i><b>12.2</b> 전통적인 60대 40 포트폴리오 백테스트</a></li>
<li class="chapter" data-level="12.3" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#시점-선택-전략-백테스트"><i class="fa fa-check"></i><b>12.3</b> 시점 선택 전략 백테스트</a></li>
<li class="chapter" data-level="12.4" data-path="포트폴리오-백테스트.html"><a href="포트폴리오-백테스트.html#동적-자산배분-백테스트"><i class="fa fa-check"></i><b>12.4</b> 동적 자산배분 백테스트</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html"><i class="fa fa-check"></i><b>13</b> 성과 및 위험 평가</a><ul>
<li class="chapter" data-level="13.1" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#결과-측정-지표"><i class="fa fa-check"></i><b>13.1</b> 결과 측정 지표</a><ul>
<li class="chapter" data-level="13.1.1" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#수익률-및-변동성"><i class="fa fa-check"></i><b>13.1.1</b> 수익률 및 변동성</a></li>
<li class="chapter" data-level="13.1.2" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#낙폭과-최대낙폭"><i class="fa fa-check"></i><b>13.1.2</b> 낙폭과 최대낙폭</a></li>
<li class="chapter" data-level="13.1.3" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#연도별-수익률"><i class="fa fa-check"></i><b>13.1.3</b> 연도별 수익률</a></li>
<li class="chapter" data-level="13.1.4" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#승률-및-롤링-윈도우-값"><i class="fa fa-check"></i><b>13.1.4</b> 승률 및 롤링 윈도우 값</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="성과-및-위험-평가.html"><a href="성과-및-위험-평가.html#팩터-회귀분석-및-테이블로-나타내기"><i class="fa fa-check"></i><b>13.2</b> 팩터 회귀분석 및 테이블로 나타내기</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://henryquant.blogspot.com/" target="blank">Henry's Quantopia</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R을 이용한 퀀트 투자 포트폴리오 만들기</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="퀀트-전략을-이용한-종목선정-심화" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> 퀀트 전략을 이용한 종목선정 (심화)</h1>
<p>지난 CHAPTER에서는 팩터를 이용한 투자 전략의 기본이 되는 저변동성, 모멘텀, 밸류, 퀄리티 전략에 대해 알아보았습니다. 물론 이러한 단일 팩터를 이용한 투자도 장기적으로 우수한 성과를 보이지만, 여러 팩터를 결합하거나 정밀하게 전략을 만든다면 더욱 우수한 성과를 거둘 수 있습니다.</p>
<p>이번 CHAPTER에서는 섹터별 효과를 없앤 후 포트폴리오를 구성하는 방법, 이상치 데이터 제거 및 팩터 결합 방법, 그리고 멀티팩터 구성 방법을 알아보겠습니다.</p>
<div id="섹터-중립-포트폴리오" class="section level2">
<h2><span class="header-section-number">10.1</span> 섹터 중립 포트폴리오</h2>
<p>팩터 전략의 단점 중 하나는 선택된 종목들이 특정 섹터로 쏠리는 경우가 있다는 점입니다. 특히 과거 수익률을 토대로 종목을 선정하는 모멘텀 전략은 특정 섹터의 호황기에 동일한 섹터의 모든 종목이 함께 움직이는 경향이 있어 이러한 쏠림이 심할 수 있습니다.</p>
<p>먼저 지난 CHAPTER에서 배운 12개월 모멘텀을 이용한 포트폴리오 구성 방법을 다시 살펴보겠습니다.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-1"></a><span class="kw">library</span>(stringr)</span>
<span id="cb363-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-2"></a><span class="kw">library</span>(xts)</span>
<span id="cb363-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-3"></a><span class="kw">library</span>(PerformanceAnalytics)</span>
<span id="cb363-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb363-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb363-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-6"></a></span>
<span id="cb363-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-7"></a>KOR_price =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_price.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb363-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-8"></a>                     <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.xts</span>()</span>
<span id="cb363-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-9"></a>KOR_ticker =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_ticker.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb363-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-10"></a>                      <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>) </span>
<span id="cb363-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-11"></a>KOR_ticker<span class="op">$</span><span class="st">&#39;종목코드&#39;</span> =</span>
<span id="cb363-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-12"></a><span class="st">  </span><span class="kw">str_pad</span>(KOR_ticker<span class="op">$</span><span class="st">&#39;종목코드&#39;</span>, <span class="dv">6</span>, <span class="st">&#39;left&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb363-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-13"></a></span>
<span id="cb363-14"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-14"></a>ret =<span class="st"> </span><span class="kw">Return.calculate</span>(KOR_price) <span class="op">%&gt;%</span><span class="st"> </span>xts<span class="op">::</span><span class="kw">last</span>(<span class="dv">252</span>) </span>
<span id="cb363-15"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-15"></a>ret_12m =<span class="st"> </span>ret <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sapply</span>(., <span class="cf">function</span>(x) {</span>
<span id="cb363-16"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-16"></a>  <span class="kw">prod</span>(<span class="dv">1</span><span class="op">+</span>x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb363-17"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-17"></a>  })</span>
<span id="cb363-18"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-18"></a></span>
<span id="cb363-19"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb363-19"></a>invest_mom =<span class="st"> </span><span class="kw">rank</span>(<span class="op">-</span>ret_12m) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span></span></code></pre></div>
<p>기존의 코드와 동일하게, 주식 가격 및 티커 데이터를 불러온 후 최근 12개월 수익률을 구해 상위 30종목을 선택합니다.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb364-1"></a>KOR_sector =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_sector.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb364-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb364-2"></a>                      <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb364-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb364-3"></a>KOR_sector<span class="op">$</span><span class="st">&#39;CMP_CD&#39;</span> =</span>
<span id="cb364-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb364-4"></a><span class="st">  </span><span class="kw">str_pad</span>(KOR_sector<span class="op">$</span><span class="st">&#39;CMP_CD&#39;</span>, <span class="dv">6</span>, <span class="st">&#39;left&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb364-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb364-5"></a>data_market =<span class="st"> </span><span class="kw">left_join</span>(KOR_ticker, KOR_sector,</span>
<span id="cb364-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb364-6"></a>                         <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&#39;종목코드&#39;</span> =<span class="st"> &#39;CMP_CD&#39;</span>,</span>
<span id="cb364-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb364-7"></a>                                <span class="st">&#39;종목명&#39;</span> =<span class="st"> &#39;CMP_KOR&#39;</span>))</span></code></pre></div>
<p>해당 종목들의 섹터 정보를 추가로 살펴보기 위해, 섹터 데이터를 불러온 후 <code>left_join()</code> 함수를 이용해 티커와 결합해 data_market에 저장합니다.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-1"></a>data_market[invest_mom, ] <span class="op">%&gt;%</span></span>
<span id="cb365-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>) <span class="op">%&gt;%</span></span>
<span id="cb365-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-3"></a><span class="st">  </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>) <span class="op">%&gt;%</span></span>
<span id="cb365-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb365-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(<span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>, <span class="st">`</span><span class="dt">n</span><span class="st">`</span>),</span>
<span id="cb365-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-6"></a>             <span class="dt">y =</span> <span class="st">`</span><span class="dt">n</span><span class="st">`</span>, <span class="dt">label =</span> n)) <span class="op">+</span></span>
<span id="cb365-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-7"></a><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></span>
<span id="cb365-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">hjust =</span> <span class="fl">-0.3</span>) <span class="op">+</span></span>
<span id="cb365-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-9"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb365-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-10"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb365-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-11"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb365-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-12"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb365-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb365-13"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>group_by()</code> 함수를 이용해 12개월 기준 모멘텀 포트폴리오 종목들의 섹터별 종목수를 계산해준 후 <code>ggplot()</code> 함수를 이용해 이를 그림으로 나타냅니다. 그림에서 알 수 있듯이 특정 섹터에 대부분의 종목이 몰려 있습니다.</p>
<p>따라서 여러 종목으로 포트폴리오를 구성했지만, 이를 분해해보면 특정 섹터에 쏠림이 심하다는 것을 알 수 있습니다. 이러한 섹터 쏠림 현상을 제거한 <strong>섹터 중립 포트폴리오</strong>를 구성해보겠습니다.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb366-1"></a>sector_neutral =<span class="st"> </span>data_market <span class="op">%&gt;%</span></span>
<span id="cb366-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb366-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">종목코드</span><span class="st">`</span>, <span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>) <span class="op">%&gt;%</span></span>
<span id="cb366-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb366-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">ret</span><span class="st">`</span> =<span class="st"> </span>ret_12m) <span class="op">%&gt;%</span></span>
<span id="cb366-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb366-4"></a><span class="st">  </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>) <span class="op">%&gt;%</span></span>
<span id="cb366-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb366-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">scale_per_sector =</span> <span class="kw">scale</span>(<span class="st">`</span><span class="dt">ret</span><span class="st">`</span>),</span>
<span id="cb366-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb366-6"></a>         <span class="dt">scale_per_sector =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(<span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>),</span>
<span id="cb366-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb366-7"></a>                                   <span class="ot">NA</span>, scale_per_sector))</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>data_market에서 종목코드와 섹터 정보를 선택합니다.</li>
<li><code>mutate()</code> 함수를 통해 미리 계산한 12개월 수익률 정보를 새로운 열에 합쳐줍니다.</li>
<li><code>group_by()</code> 함수를 통해 섹터별 그룹을 만들어줍니다</li>
<li><code>scale()</code> 함수를 이용해 그룹별 정규화를 해줍니다. 정규화는 <span class="math inline">\(\frac{x- \mu}{\sigma}\)</span>로 계산됩니다.</li>
<li>섹터 정보가 없을 경우 NA로 변경합니다.</li>
</ol>
<p>위의 정규화 과정을 살펴보면, 전체 종목에서 12개월 수익률을 비교하는 것이 아닌 각 섹터별로 수익률의 강도를 비교하게 됩니다. 따라서 특정 종목의 과거 수익률이 전체 종목과 비교해서 높았더라도 해당 섹터 내에서의 순위가 낮다면, 정규화된 값은 낮아집니다.</p>
<p>따라서 섹터별 정규화 과정을 거친 값으로 비교 분석을 한다면, 섹터 효과가 제거된 포트폴리오를 구성할 수 있습니다.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-1"></a>invest_mom_neutral =</span>
<span id="cb367-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-2"></a><span class="st">  </span><span class="kw">rank</span>(<span class="op">-</span>sector_neutral<span class="op">$</span>scale_per_sector) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span></span>
<span id="cb367-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-3"></a></span>
<span id="cb367-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-4"></a>data_market[invest_mom_neutral, ] <span class="op">%&gt;%</span></span>
<span id="cb367-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-5"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>) <span class="op">%&gt;%</span></span>
<span id="cb367-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-6"></a><span class="st">  </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>) <span class="op">%&gt;%</span></span>
<span id="cb367-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-7"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb367-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(<span class="st">`</span><span class="dt">SEC_NM_KOR</span><span class="st">`</span>, <span class="st">`</span><span class="dt">n</span><span class="st">`</span>),</span>
<span id="cb367-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-9"></a>             <span class="dt">y =</span> <span class="st">`</span><span class="dt">n</span><span class="st">`</span>, <span class="dt">label =</span> n)) <span class="op">+</span></span>
<span id="cb367-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-10"></a><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></span>
<span id="cb367-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-11"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">hjust =</span> <span class="fl">-0.3</span>) <span class="op">+</span></span>
<span id="cb367-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-12"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb367-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-13"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb367-14"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-14"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb367-15"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-15"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb367-16"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb367-16"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>정규화된 값의 랭킹이 높은 상위 30종목을 선택하며, 내림차순을 위해 마이너스(-)를 붙여줍니다. 해당 포트폴리오의 섹터별 구성종목을 확인해보면, 단순하게 포트폴리오를 구성한 것에 대비하여 여러 섹터에 종목이 분산되어 있습니다.</p>
<p>이처럼 <code>group_by()</code> 함수를 통해 손쉽게 그룹별 중립화를 할 수 있으며, 글로벌 투자를 하는 경우에는 지역, 국가, 섹터별로도 중립화된 포트폴리오를 구성하기도 합니다.</p>
</div>
<div id="마법공식" class="section level2">
<h2><span class="header-section-number">10.2</span> 마법공식</h2>
<p>하나의 팩터만을 보고 투자하는 것보다, 둘 혹은 그 이상의 팩터를 결합해 투자해야 훨씬 좋은 포트폴리오를 구성할 수 있으며, 이러한 방법을 멀티팩터라고 합니다. 그중에서도 밸류와 퀄리티의 조합은 전통적으로 많이 사용된 방법이며, 대표적인 예가 조엘 그린블라트의 마법공식<span class="citation">(Greenblatt <a href="#ref-greenblatt2010little" role="doc-biblioref">2010</a>)</span>입니다. 이에 앞서, 퀄리티와 밸류 간의 관계, 마법공식의 정의와 구성 방법을 알아보겠습니다.</p>
<div id="퀄리티와-밸류-간의-관계" class="section level3">
<h3><span class="header-section-number">10.2.1</span> 퀄리티와 밸류 간의 관계</h3>
<p>투자의 정석 중 하나는 <strong>좋은 기업을 싸게 사는 것</strong>입니다. 이를 팩터의 관점에서 이해하면 퀄리티 팩터와 밸류 팩터로 이해할 수도 있습니다.</p>
<p>여러 논문에 따르면 흔히 밸류 팩터와 퀄리티 팩터는 반대의 관계<span class="citation">(Novy-Marx <a href="#ref-novy2013other" role="doc-biblioref">2013</a>)</span>에 있습니다. 먼저 가치주들은 위험이 크기 때문에 시장에서 소외를 받아 저평가가 이루어지는 것이며, 이러한 위험에 대한 대가로 밸류 팩터의 수익률이 높게 됩니다. 반대로 사람들은 우량주에 기꺼이 프리미엄을 지불하려 하기 때문에 퀄리티 팩터의 수익률이 높기도 합니다. 이는 마치 동전의 양면과 같지만, 장기적으로 가치주와 우량주 모두 우수한 성과를 기록합니다. 먼저 퀄리티의 지표인 매출총이익과 밸류 지표인 PBR을 통해 둘 사이의 관계를 확인해 보겠습니다.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-1"></a><span class="kw">library</span>(stringr)</span>
<span id="cb368-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb368-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-3"></a></span>
<span id="cb368-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-4"></a>KOR_value =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_value.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb368-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-5"></a>                     <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb368-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-6"></a>KOR_fs =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/KOR_fs.Rds&#39;</span>)</span>
<span id="cb368-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-7"></a>KOR_ticker =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_ticker.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb368-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-8"></a>                      <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>) </span>
<span id="cb368-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-9"></a></span>
<span id="cb368-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-10"></a>data_pbr =<span class="st"> </span>KOR_value[<span class="st">&#39;PBR&#39;</span>]</span>
<span id="cb368-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-11"></a></span>
<span id="cb368-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-12"></a><span class="cf">if</span> ( lubridate<span class="op">::</span><span class="kw">month</span>(<span class="kw">Sys.Date</span>()) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) ) {</span>
<span id="cb368-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-13"></a>  num_col =<span class="st"> </span><span class="kw">str_which</span>(<span class="kw">colnames</span>(KOR_fs[[<span class="dv">1</span>]]), <span class="kw">as.character</span>(lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">Sys.Date</span>()) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb368-14"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-14"></a>} <span class="cf">else</span> {</span>
<span id="cb368-15"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-15"></a>  num_col =<span class="st"> </span><span class="kw">str_which</span>(<span class="kw">colnames</span>(KOR_fs[[<span class="dv">1</span>]]), <span class="kw">as.character</span>(lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">Sys.Date</span>()) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb368-16"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-16"></a>}</span>
<span id="cb368-17"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-17"></a></span>
<span id="cb368-18"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-18"></a>data_gpa =</span>
<span id="cb368-19"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-19"></a><span class="st">  </span>(KOR_fs<span class="op">$</span><span class="st">&#39;매출총이익&#39;</span> <span class="op">/</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;자산&#39;</span>)[num_col] <span class="op">%&gt;%</span></span>
<span id="cb368-20"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-20"></a><span class="st">  </span><span class="kw">setNames</span>(<span class="st">&#39;GPA&#39;</span>)</span>
<span id="cb368-21"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-21"></a></span>
<span id="cb368-22"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-22"></a><span class="kw">cbind</span>(data_pbr, <span class="op">-</span>data_gpa) <span class="op">%&gt;%</span></span>
<span id="cb368-23"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb368-23"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">method =</span> <span class="st">&#39;spearman&#39;</span>, <span class="dt">use =</span> <span class="st">&#39;complete.obs&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##         PBR     GPA
## PBR  1.0000 -0.2005
## GPA -0.2005  1.0000</code></pre>
<p>데이터를 불러온 후 PBR과 GPA(매출총이익/자산)를 구합니다. 그 후 랭킹의 상관관계인 스피어만 상관관계를 구해보면, 서로 간에 반대 관계가 있음이 확인됩니다. PBR은 오름차순, GPA는 내림차순이므로 GPA 앞에 마이너스(-)를 붙여주었습니다.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb370-1"></a><span class="kw">cbind</span>(data_pbr, data_gpa) <span class="op">%&gt;%</span></span>
<span id="cb370-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb370-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">quantile_pbr =</span> <span class="kw">ntile</span>(data_pbr, <span class="dv">5</span>)) <span class="op">%&gt;%</span></span>
<span id="cb370-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb370-3"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(quantile_pbr)) <span class="op">%&gt;%</span></span>
<span id="cb370-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb370-4"></a><span class="st">  </span><span class="kw">group_by</span>(quantile_pbr) <span class="op">%&gt;%</span></span>
<span id="cb370-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb370-5"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_gpa =</span> <span class="kw">mean</span>(GPA, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb370-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb370-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> quantile_pbr, <span class="dt">y =</span> mean_gpa)) <span class="op">+</span></span>
<span id="cb370-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb370-7"></a><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></span>
<span id="cb370-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb370-8"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;PBR&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;GPA&#39;</span>)</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이번에는 PBR의 분위수별 GPA 평균값을 구하겠습니다.</p>
<ol style="list-style-type: decimal">
<li><code>ntile()</code> 함수를 이용해 PBR을 5분위수로 나누어줍니다.</li>
<li>PBR이 없는 종목은 제외합니다.</li>
<li><code>group_by()</code>함수를 통해 PBR의 분위수별 그룹을 묶어줍니다.</li>
<li>각 PBR 그룹별 GPA의 평균값을 구해줍니다.</li>
<li><code>ggplot()</code> 함수를 이용해 시각화를 해줍니다</li>
</ol>
<p>그림에서 알 수 있듯이 PBR이 낮을수록 GPA도 낮으며, 즉 가치주일수록 우량성은 떨어집니다. 반면에 PBR이 높을수록 GPA도 높으며, 이는 주식의 가격이 비쌀수록 우량성도 높다는 뜻입니다.</p>
<p>이를 이용해 밸류 팩터와 퀄리티 팩터 간의 관계를 나타내면 다음과 같습니다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-8"></span>
<img src="images/tableqv.png" alt="밸류 팩터와 퀄리티 팩터간의 관계" width="50%" />
<p class="caption">
그림 10.1: 밸류 팩터와 퀄리티 팩터간의 관계
</p>
</div>
<p>주가가 쌀수록 기업의 우량성은 떨어지며(①번), 반대로 기업의 우량성이 좋으면 주식은 비싼 경향(③번)이 있습니다. 물론 우량성도 떨어지고 비싸기만한 주식(②번)을 사려는 사람들 아마 없을 겁니다. 결과적으로 우리가 원하는 최고의 주식은 우량성이 있으면서도 가격은 싼 주식(④번)입니다.</p>
</div>
<div id="마법공식-이해하기" class="section level3">
<h3><span class="header-section-number">10.2.2</span> 마법공식 이해하기</h3>
<p>마법공식이란 고담 캐피탈의 설립자이자 전설적인 투자자 조엘 그린블라트에 의해 알려진 투자 방법입니다. 그는 본인의 책 《주식 시장을 이기는 작은 책》에서 투자를 하는데 있어 중요한 두 가지 지표가 있으며, 이를 혼합하면 뛰어난 성과를 기록할 수 있다고 했습니다.</p>
<p>첫 번째 지표는 <strong>이율(Earnings Yield)</strong>로서 기업의 수익을 기업의 가치로 나는 값입니다. 이는 PER의 역수와 비슷하며, 밸류 지표 중 하나입니다. 두 번째 지표는 <strong>투하자본 수익률(Return on Capital)</strong>로서 기업의 수익을 투자한 자본으로 나눈 값입니다. 이는 ROE와도 비슷하며, 퀄리티 지표 중 하나입니다. 마법공식은 이 두 가지 지표의 랭킹을 각각 구한 후 랭킹의 합 기준 상위 30개 종목을 1년간 보유한 후 매도하는 전략입니다.</p>
<p>해당 전략은 국내 투자자들에게도 많이 사랑받는 전략이지만 두 지표를 계산하기 위한 데이터를 수집하기 어려워 많은 투자자들이 이율 대신 PER를 사용하고, 투하자본 수익률 대신 ROE를 사용합니다. 그러나 우리가 수집한 데이터를 통해 충분히 원래의 마법공식을 구현할 수 있습니다.</p>
<table>
<caption><span id="tab:unnamed-chunk-9">표 10.1: </span>마법공식의 구성 요소</caption>
<thead>
<tr class="header">
<th align="center">팩터</th>
<th align="center">Value</th>
<th align="center">Quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">지표</td>
<td align="center">이율 (Earnings Yield)</td>
<td align="center">투하자본 수익률 (Return On Capital)</td>
</tr>
<tr class="even">
<td align="center">계산</td>
<td align="center"><span class="math inline">\(\frac{이자\,및\,법인세\,차감전이익}{기업\,가치}\)</span></td>
<td align="center"><span class="math inline">\(\frac{이자\,및\,법인세\,차감전이익}{투하자본}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="마법공식-구성하기" class="section level3">
<h3><span class="header-section-number">10.2.3</span> 마법공식 구성하기</h3>
<p>재무제표 항목을 통해 이율과 투하자본 수익률을 계산하고, 이를 통해 마법공식 포트폴리오를 구성하겠습니다. 먼저 밸류 지표에 해당하는 이익수익률을 계산해보겠습니다. 이익수익률은 이자 및 법인세 차감전이익(EBIT)을 기업가치(시가총액 + 순차입금)로 나눈 값입니다. 이를 분해하면 다음과 같습니다.</p>
<p><span class="math display">\[\begin{equation*} 
\begin{split}
 이익수익률 &amp; = \frac{이자\,및\,법인세\,차감전이익}{기업\,가치} \\
&amp; = \frac{이자\,및\,법인세\,차감전이익}{시가총액 + 순차입금} \\
&amp; = \frac{당기순이익 + 법인세 + 이자비용}{시가총액 + 총부채 - 여유자금} \\
&amp; = \frac{당기순이익 + 법인세 + 이자비용}{시가총액 + 총부채 - (현금 - max(0, 유동부채 - 유동자산 + 현금))}
\end{split}
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-1"></a><span class="kw">library</span>(stringr)</span>
<span id="cb371-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb371-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-3"></a></span>
<span id="cb371-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-4"></a>KOR_value =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_value.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb371-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-5"></a>                     <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb371-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-6"></a>KOR_fs =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/KOR_fs.Rds&#39;</span>)</span>
<span id="cb371-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-7"></a>KOR_ticker =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_ticker.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb371-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-8"></a>                      <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>) </span>
<span id="cb371-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-9"></a>KOR_ticker<span class="op">$</span><span class="st">&#39;종목코드&#39;</span> =</span>
<span id="cb371-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-10"></a><span class="st">  </span><span class="kw">str_pad</span>(KOR_ticker<span class="op">$</span><span class="st">&#39;종목코드&#39;</span>, <span class="dv">6</span>, <span class="st">&#39;left&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb371-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-11"></a></span>
<span id="cb371-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-12"></a><span class="cf">if</span> ( lubridate<span class="op">::</span><span class="kw">month</span>(<span class="kw">Sys.Date</span>()) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) ) {</span>
<span id="cb371-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-13"></a>  num_col =<span class="st"> </span><span class="kw">str_which</span>(<span class="kw">colnames</span>(KOR_fs[[<span class="dv">1</span>]]), <span class="kw">as.character</span>(lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">Sys.Date</span>()) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb371-14"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-14"></a>} <span class="cf">else</span> {</span>
<span id="cb371-15"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-15"></a>  num_col =<span class="st"> </span><span class="kw">str_which</span>(<span class="kw">colnames</span>(KOR_fs[[<span class="dv">1</span>]]), <span class="kw">as.character</span>(lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">Sys.Date</span>()) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb371-16"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-16"></a>}</span>
<span id="cb371-17"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-17"></a></span>
<span id="cb371-18"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-18"></a><span class="co"># 분자</span></span>
<span id="cb371-19"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-19"></a>magic_ebit =<span class="st"> </span>(KOR_fs<span class="op">$</span><span class="st">&#39;지배주주순이익&#39;</span> <span class="op">+</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;법인세비용&#39;</span> <span class="op">+</span></span>
<span id="cb371-20"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-20"></a><span class="st">                </span>KOR_fs<span class="op">$</span><span class="st">&#39;이자비용&#39;</span>)[num_col]</span>
<span id="cb371-21"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-21"></a></span>
<span id="cb371-22"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-22"></a><span class="co"># 분모</span></span>
<span id="cb371-23"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-23"></a>magic_cap =<span class="st"> </span>KOR_value<span class="op">$</span>PER <span class="op">*</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;지배주주순이익&#39;</span>[num_col]</span>
<span id="cb371-24"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-24"></a>magic_debt =<span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;부채&#39;</span>[num_col]</span>
<span id="cb371-25"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-25"></a>magic_excess_cash_<span class="dv">1</span> =<span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;유동부채&#39;</span> <span class="op">-</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;유동자산&#39;</span> <span class="op">+</span></span>
<span id="cb371-26"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-26"></a><span class="st">  </span>KOR_fs<span class="op">$</span><span class="st">&#39;현금및현금성자산&#39;</span></span>
<span id="cb371-27"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-27"></a>magic_excess_cash_<span class="dv">1</span>[magic_excess_cash_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb371-28"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-28"></a>magic_excess_cash_<span class="dv">2</span> =</span>
<span id="cb371-29"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-29"></a><span class="st">  </span>(KOR_fs<span class="op">$</span><span class="st">&#39;현금및현금성자산&#39;</span> <span class="op">-</span><span class="st"> </span>magic_excess_cash_<span class="dv">1</span>)[num_col]</span>
<span id="cb371-30"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-30"></a></span>
<span id="cb371-31"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-31"></a>magic_ev =<span class="st"> </span>magic_cap <span class="op">+</span><span class="st"> </span>magic_debt <span class="op">-</span><span class="st"> </span>magic_excess_cash_<span class="dv">2</span></span>
<span id="cb371-32"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-32"></a></span>
<span id="cb371-33"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-33"></a><span class="co"># 이익수익률</span></span>
<span id="cb371-34"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb371-34"></a>magic_ey =<span class="st"> </span>magic_ebit <span class="op">/</span><span class="st"> </span>magic_ev</span></code></pre></div>
<p>가치지표, 재무제표, 티커 데이터를 불러온 후 재무제표 열 개수를 구합니다. 그후 분자와 분모 항목에 해당하는 부분을 하나씩 계산합니다. 먼저 분자 부분인 <strong>이자및 법인세 차감전이익은 지배주주 순이익에 법인세비용과 이자비용을 더해준 후</strong> 최근년도 데이터를 선택합니다.</p>
<p>분모 부분은 시가총액, 총 부채, 여유자금 총 세 가지로 구성되어 있습니다.</p>
<ol style="list-style-type: decimal">
<li>우리가 가지고 있는 밸류 데이터와 재무제표 데이터를 통해 시가총액을 역산할 수 있습니다. PER 값에 Earnings를 곱해주면 시가총액이 계산됩니다. 이를 통해 계산된 시가총액을 HTS나 금융 웹사이트의 값과 비교하면 거의 비슷함이 확인됩니다.</li>
</ol>
<p><span class="math display">\[\begin{equation*} 
\begin{split}
PER \times Earnings &amp; = \frac{Price}{Earnings/Shares} \times Earnings \\
&amp; = \frac{Price \times Shares}{Earnings} \times Earnings \\
&amp; = Price \times Shares = Market\,Cap
\end{split}
\end{equation*}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>총 부채는 부채 항목을 사용합니다.</li>
<li>여유자금은 두 단계에 걸쳐 계산합니다. 먼저 <strong>유동부채 - 유동자산 + 현금</strong> 값을 구해준 후 0보다 작은 값은 모두 0으로 바꿔줍니다. 이 값을 현금 및 현금성자산 항목에서 차감해 최종적인 여유자금을 구합니다.</li>
</ol>
<p>분자와 분모 부분을 나누어주면 이익수익률을 계산할 수 있습니다.</p>
<p>다음으로 퀄리티 지표에 해당하는 투하자본 수익률을 계산하겠습니다. 해당 값은 이자 및 법인세 차감전이익(EBIT)를 투하자본(IC)으로 나누어 계산되며, 이를 분해하면 다음과 같습니다.</p>
<p><span class="math display">\[\begin{equation*} 
\begin{split}
투하자본\,수익률 &amp; = \frac{이자\,및\,법인세\,차감전이익}{투하자본} \\
&amp; = \frac{당기순이익 + 법인세 + 이자비용}{(유동자산 - 유동부채) + (비유동자산 - 감가상각비)}
\end{split}
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb372-1"></a>magic_ic =<span class="st"> </span>((KOR_fs<span class="op">$</span><span class="st">&#39;유동자산&#39;</span> <span class="op">-</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;유동부채&#39;</span>) <span class="op">+</span></span>
<span id="cb372-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb372-2"></a><span class="st">              </span>(KOR_fs<span class="op">$</span><span class="st">&#39;비유동자산&#39;</span> <span class="op">-</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;감가상각비&#39;</span>))[num_col]</span>
<span id="cb372-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb372-3"></a>magic_roc =<span class="st"> </span>magic_ebit <span class="op">/</span><span class="st"> </span>magic_ic</span></code></pre></div>
<p>투하자본 수익률은 비교적 쉽게 계산할 수 있습니다. 분모에 해당하는 투하자본의 경우 재무제표 항목을 그대로 사용하면 되며, 분자인 이자 및 법인세 차감전이익은 위에서 이미 구해둔 값을 사용하면 됩니다.</p>
<p>이제 두 지표를 활용해 마법공식 포트폴리오를 구성하겠습니다.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb373-1"></a>invest_magic =<span class="st"> </span><span class="kw">rank</span>(<span class="kw">rank</span>(<span class="op">-</span>magic_ey) <span class="op">+</span><span class="st"> </span><span class="kw">rank</span>(<span class="op">-</span>magic_roc)) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span></span>
<span id="cb373-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb373-2"></a></span>
<span id="cb373-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb373-3"></a>KOR_ticker[invest_magic, ] <span class="op">%&gt;%</span></span>
<span id="cb373-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb373-4"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">종목코드</span><span class="st">`</span>, <span class="st">`</span><span class="dt">종목명</span><span class="st">`</span>) <span class="op">%&gt;%</span></span>
<span id="cb373-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb373-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">이익수익률</span><span class="st">`</span> =<span class="st"> </span><span class="kw">round</span>(magic_ey[invest_magic, ], <span class="dv">4</span>),</span>
<span id="cb373-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb373-6"></a>         <span class="st">`</span><span class="dt">투하자본수익률</span><span class="st">`</span> =<span class="st"> </span><span class="kw">round</span>(magic_roc[invest_magic, ], <span class="dv">4</span>))</span></code></pre></div>
<pre><code>##    종목코드          종목명 이익수익률 투하자본수익률
## 1    294870 HDC현대산업개발     0.1583         0.2167
## 2    036830  솔브레인홀딩스     0.1702         0.2160
## 3    097520        엠씨넥스     0.1058         0.6846
## 4    204270      제이앤티씨     0.1230         0.2881
## 5    091700          파트론     0.1447         0.2802
## 6    097230      한진중공업     0.1314         0.7292
## 7    033290        코웰패션     0.1179         0.2721
## 8    066700    테라젠이텍스     0.1527         0.3543
## 9    053610          프로텍     0.2033         0.2352
## 10   031330    에스에이엠티     0.1674         0.1988
## 11   002170        삼양통상     0.2619         0.1780
## 12   083450             GST     0.1400         0.2246
## 13   038460    바이오스마트     0.1653         0.2663
## 14   007720    대명소노시즌     0.8761         0.4021
## 15   004650      창해에탄올     0.1625         0.2673
## 16   057540      옴니시스템     0.2036         0.2795
## 17   056360          코위버     0.1941         0.2021
## 18   065710        서호전기     0.1755         0.2550
## 19   052790    액토즈소프트     0.1977         0.2136
## 20   198080          엔피디     0.1314         0.3047
## 21   225190      삼양옵틱스     0.1717         0.4109
## 22   050760      에스폴리텍     0.1194         0.2589
## 23   032940            원익     0.2939         0.3740
## 24   005670          푸드웰     0.3436         0.4751
## 25   032750            삼진     0.1702         0.1954
## 26   084670        동양고속     0.3151         0.2724
## 27   003780        진양산업     0.1342         0.2238
## 28   014100        메디앙스     0.4599         0.3979
## 29   010640        진양폴리     0.1808         0.2803
## 30   083470      이엠앤아이     0.6918         9.5517</code></pre>
<p>이익수익률과 투하자본 수익률의 랭킹을 각각 구해주며, 내림차순으로 값을 구하기 위해 마이너스(-)를 붙여줍니다. 그 후 두 값의 합의 랭킹 기준 상위 30종목을 선택한 후 종목코드, 종목명과 각 지표를 확인합니다.</p>
</div>
</div>
<div id="이상치-데이터-제거-및-팩터의-결합" class="section level2">
<h2><span class="header-section-number">10.3</span> 이상치 데이터 제거 및 팩터의 결합</h2>
<p>모든 데이터 분석에서 중요한 문제 중 하나가 이상치(극단치, Outlier) 데이터를 어떻게 처리할 것인가입니다. 과거 12개월 수익률이 10배인 주식이 과연 모멘텀 관점에서 좋기만 한 주식인지, ROE가 100% 넘는 주식이 과연 퀄리티 관점에서 좋기만 한 주식인지 고민이 되기 마련입니다.</p>
<p>따라서 이러한 이상치를 제외하고 분석할지, 포함해서 분석할지를 판단해야 합니다. 만일 이상치를 포함한다면 그대로 사용할 것인지, 보정해 사용할 것인지도 판단해야 합니다.</p>
<p>우리가 가지고 있는 데이터에서 이상치 데이터를 탐색해보겠습니다.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb375-1"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb375-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb375-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb375-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb375-3"></a></span>
<span id="cb375-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb375-4"></a>KOR_value =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_value.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb375-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb375-5"></a>                     <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb375-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb375-6"></a></span>
<span id="cb375-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb375-7"></a><span class="kw">max</span>(KOR_value<span class="op">$</span>PBR, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 508.7</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb377-1"></a>KOR_value <span class="op">%&gt;%</span></span>
<span id="cb377-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb377-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PBR)) <span class="op">+</span></span>
<span id="cb377-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb377-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>국내 종목들의 PBR 히스토그램을 그려보면 오른쪽으로 꼬리가 매우 긴 분포를 보이고 있습니다. 이는 PBR이 무려 508.71인 이상치 데이터가 있기 때문입니다. 이처럼 모든 팩터 지표에는 극단치 데이터가 있기 마련이며, 이를 처리하는 방법을 알아보겠습니다.</p>
<div id="트림trim-이상치-데이터-삭제" class="section level3">
<h3><span class="header-section-number">10.3.1</span> 트림(Trim): 이상치 데이터 삭제</h3>
<p>트림은 이상치 데이터를 삭제하는 방법입니다. 위의 예제에서 이상치에 해당하는 상하위 1% 데이터를 삭제하겠습니다.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb378-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-2"></a></span>
<span id="cb378-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-3"></a>value_trim =<span class="st"> </span>KOR_value <span class="op">%&gt;%</span></span>
<span id="cb378-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-4"></a><span class="st">  </span><span class="kw">select</span>(PBR) <span class="op">%&gt;%</span></span>
<span id="cb378-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PBR =</span> <span class="kw">ifelse</span>(<span class="kw">percent_rank</span>(PBR) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.99</span>, <span class="ot">NA</span>, PBR),</span>
<span id="cb378-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-6"></a>         <span class="dt">PBR =</span> <span class="kw">ifelse</span>(<span class="kw">percent_rank</span>(PBR) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>, <span class="ot">NA</span>, PBR))</span>
<span id="cb378-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-7"></a></span>
<span id="cb378-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-8"></a>value_trim <span class="op">%&gt;%</span></span>
<span id="cb378-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PBR)) <span class="op">+</span></span>
<span id="cb378-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb378-10"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>percent_rank()</code> 함수를 통해 백분위를 구한 후 상하위 1%에 해당하는 데이터들은 NA로 변경했습니다. 결과적으로 지나치게 PBR이 낮은 종목과 높은 종목은 제거되어 x축의 스케일이 많이 줄어든 모습입니다.</p>
<p>평균이나 분산같이 통곗값을 구하는 과정에서는 이상치 데이터를 제거하는 것이 바람직할 수 있습니다. 그러나 팩터를 이용해 포트폴리오를 구하는 과정에서 해당 방법은 잘 사용되지 않습니다. 데이터의 손실이 발생하게 되며, 제거된 종목 중 정말로 좋은 종목이 있을 수도 있기 때문입니다.</p>
</div>
<div id="윈저라이징winsorizing-이상치-데이터-대체" class="section level3">
<h3><span class="header-section-number">10.3.2</span> 윈저라이징(Winsorizing): 이상치 데이터 대체</h3>
<p>포트폴리오 구성에서는 일반적으로 이상치 데이터를 다른 데이터로 대체하는 윈저라이징 방법이 사용됩니다. 예를 들어 상위 99%를 초과하는 데이터는 99% 값으로 대체하며, 하위 1% 미만의 데이터는 1% 데이터로 대체합니다. 즉, 좌우로 울타리를 쳐놓고 해당 범위를 넘어가는 값을 강제로 울타리에 맞춰줍니다.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-1"></a>value_winsor =<span class="st"> </span>KOR_value <span class="op">%&gt;%</span></span>
<span id="cb379-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-2"></a><span class="st">  </span><span class="kw">select</span>(PBR) <span class="op">%&gt;%</span></span>
<span id="cb379-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PBR =</span> <span class="kw">ifelse</span>(<span class="kw">percent_rank</span>(PBR) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.99</span>,</span>
<span id="cb379-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-4"></a>                      <span class="kw">quantile</span>(., <span class="fl">0.99</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), PBR),</span>
<span id="cb379-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-5"></a>         <span class="dt">PBR =</span> <span class="kw">ifelse</span>(<span class="kw">percent_rank</span>(PBR) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>,</span>
<span id="cb379-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-6"></a>                      <span class="kw">quantile</span>(., <span class="fl">0.01</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), PBR))</span>
<span id="cb379-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-7"></a></span>
<span id="cb379-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-8"></a>value_winsor <span class="op">%&gt;%</span></span>
<span id="cb379-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PBR)) <span class="op">+</span></span>
<span id="cb379-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb379-10"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>역시나 <code>percent_rank()</code> 함수를 통해 백분위를 구한 후 해당 범위를 초과할 경우 각각 상하위 1% 데이터로 변형해줍니다. 그림을 살펴보면 x축 양 끝부분의 막대가 길어진 것을 확인할 수 있습니다.</p>
</div>
<div id="팩터의-결합-방법" class="section level3">
<h3><span class="header-section-number">10.3.3</span> 팩터의 결합 방법</h3>
<p>밸류 지표의 결합, 퀄리티 지표의 결합, 마법공식 포트폴리오를 구성할 때 단순히 랭킹을 더하는 방법을 사용했습니다. 물론 투자 종목수가 얼마 되지 않거나, 개인 투자자의 입장에서는 이러한 방법이 가장 단순하면서도 효과적일수 있습니다. 그러나 전문투자자의 입장이거나 팩터를 분석하는 업무를 할 경우 이처럼 단순히 랭킹을 더하는 방법은 여러 가지 문제를 안고 있습니다.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb380-1"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb380-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb380-2"></a>  </span>
<span id="cb380-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb380-3"></a>KOR_value <span class="op">%&gt;%</span></span>
<span id="cb380-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb380-4"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">min_rank</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb380-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb380-5"></a><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></span>
<span id="cb380-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb380-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb380-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb380-7"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb380-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb380-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>key)  </span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>앞의 그림은 각 밸류 지표의 랭킹을 구한 후 히스토그램으로 나타낸 것입니다. 랭킹을 구하는 것의 가장 큰 장점은 극단치로 인한 효과가 사라진다는 점과 균등한 분포를 가진다는 점입니다.</p>
<p>그러나 각 지표의 x축을 보면 최댓값이 서로 다릅니다. 이는 지표별 결측치로 인해 유효 데이터의 개수가 달라 나타나는 현상이며, 서로 다른 범위의 분포를 단순히 합치는 것은 좋은 방법이 아닙니다. 예를 들어 A, B, C, D 팩터에 각각 비중을 40%, 30%, 20%, 10% 부여해 포트폴리오를 구성한다고 가정해봅시다. 각 랭킹은 분포의 범위가 다르므로, 랭킹과 비중의 가중평균을 통해 포트폴리오를 구성하면 왜곡된 결과를 발생시킵니다.</p>
<p>이러한 문제를 해결하는 가장 좋은 방법은 랭킹을 구한 후 이를 Z-Score로 정규화하는 것입니다.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb381-1"></a>KOR_value <span class="op">%&gt;%</span></span>
<span id="cb381-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb381-2"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">min_rank</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb381-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb381-3"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">scale</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb381-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb381-4"></a><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></span>
<span id="cb381-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb381-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb381-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb381-6"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb381-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb381-7"></a><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>key)  </span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>min_rank()</code> 함수를 통해 랭킹을 구한 후, <code>scale()</code> 함수를 통해 정규화를 해주었습니다. 기본적으로 랭킹의 분포가 가진 극단치 효과가 사라지는 점과 균등 분포의 장점을 유지하고 있으며, 분포의 범위 역시 거의 동일하게 바뀌었습니다.</p>
<p>이처럼 여러 팩터를 결합해 포트폴리오를 구성하고자 하는 경우, 먼저 각 팩터(지표)별 랭킹을 정규화한 뒤 더해야 왜곡 효과가 제거되어 안정적입니다.</p>
<p><span class="math display">\[\begin{equation*} 
Z - Score(Rank(Factor\,A)) + Z - Score(Rank(Factor\,B)) +\,\dots\,+ Z - Score(Rank(Factor\,N))
\end{equation*}\]</span></p>
</div>
</div>
<div id="멀티팩터-포트폴리오" class="section level2">
<h2><span class="header-section-number">10.4</span> 멀티팩터 포트폴리오</h2>
<p>앞에서 배웠던 팩터 이론들과 결합 방법들을 응용해 멀티팩터 포트폴리오를 구성해보겠습니다. 각 팩터에 사용되는 지표는 다음과 같습니다.</p>
<ul>
<li><strong>퀄리티</strong>: 자기자본이익률, 매출총이익, 영업활동현금흐름</li>
<li><strong>밸류</strong>: PER, PBR, PSR, PCR</li>
<li><strong>모멘텀</strong>: 3개월 수익률, 6개월 수익률, 12개월 수익률</li>
</ul>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-1"></a><span class="kw">library</span>(xts)</span>
<span id="cb382-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-2"></a><span class="kw">library</span>(stringr)</span>
<span id="cb382-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-3"></a></span>
<span id="cb382-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-4"></a>KOR_fs =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/KOR_fs.Rds&#39;</span>)</span>
<span id="cb382-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-5"></a>KOR_value =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_value.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb382-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-6"></a>                     <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb382-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-7"></a>KOR_price =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_price.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb382-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-8"></a>                     <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.xts</span>()</span>
<span id="cb382-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-9"></a></span>
<span id="cb382-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-10"></a>KOR_ticker =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/KOR_ticker.csv&#39;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb382-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-11"></a>                      <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>) </span>
<span id="cb382-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-12"></a>KOR_ticker<span class="op">$</span><span class="st">&#39;종목코드&#39;</span> =</span>
<span id="cb382-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb382-13"></a><span class="st">  </span><span class="kw">str_pad</span>(KOR_ticker<span class="op">$</span><span class="st">&#39;종목코드&#39;</span>, <span class="dv">6</span>, <span class="st">&#39;left&#39;</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>먼저 재무제표, 가치지표, 주가 데이터를 불러옵니다.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-1"></a><span class="cf">if</span> ( lubridate<span class="op">::</span><span class="kw">month</span>(<span class="kw">Sys.Date</span>()) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) ) {</span>
<span id="cb383-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-2"></a>  num_col =<span class="st"> </span><span class="kw">str_which</span>(<span class="kw">colnames</span>(KOR_fs[[<span class="dv">1</span>]]), <span class="kw">as.character</span>(lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">Sys.Date</span>()) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb383-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-3"></a>} <span class="cf">else</span> {</span>
<span id="cb383-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-4"></a>  num_col =<span class="st"> </span><span class="kw">str_which</span>(<span class="kw">colnames</span>(KOR_fs[[<span class="dv">1</span>]]), <span class="kw">as.character</span>(lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">Sys.Date</span>()) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb383-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-5"></a>}</span>
<span id="cb383-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-6"></a></span>
<span id="cb383-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-7"></a>quality_roe =<span class="st"> </span>(KOR_fs<span class="op">$</span><span class="st">&#39;지배주주순이익&#39;</span> <span class="op">/</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;자본&#39;</span>)[num_col]</span>
<span id="cb383-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-8"></a>quality_gpa =<span class="st"> </span>(KOR_fs<span class="op">$</span><span class="st">&#39;매출총이익&#39;</span> <span class="op">/</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;자산&#39;</span>)[num_col]</span>
<span id="cb383-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-9"></a>quality_cfo =</span>
<span id="cb383-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-10"></a><span class="st">  </span>(KOR_fs<span class="op">$</span><span class="st">&#39;영업활동으로인한현금흐름&#39;</span> <span class="op">/</span><span class="st"> </span>KOR_fs<span class="op">$</span><span class="st">&#39;자산&#39;</span>)[num_col]</span>
<span id="cb383-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-11"></a></span>
<span id="cb383-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-12"></a>quality_profit =</span>
<span id="cb383-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-13"></a><span class="st">  </span><span class="kw">cbind</span>(quality_roe, quality_gpa, quality_cfo) <span class="op">%&gt;%</span></span>
<span id="cb383-14"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-14"></a><span class="st">  </span><span class="kw">setNames</span>(., <span class="kw">c</span>(<span class="st">&#39;ROE&#39;</span>, <span class="st">&#39;GPA&#39;</span>, <span class="st">&#39;CFO&#39;</span>))</span>
<span id="cb383-15"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-15"></a></span>
<span id="cb383-16"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-16"></a>factor_quality =<span class="st"> </span>quality_profit <span class="op">%&gt;%</span></span>
<span id="cb383-17"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-17"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">min_rank</span>(<span class="kw">desc</span>(.)))) <span class="op">%&gt;%</span></span>
<span id="cb383-18"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-18"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">scale</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb383-19"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-19"></a><span class="st">  </span><span class="kw">rowSums</span>()</span>
<span id="cb383-20"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-20"></a></span>
<span id="cb383-21"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-21"></a>factor_quality <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb383-22"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-22"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb383-23"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-23"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">.</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb383-24"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb383-24"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-19-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>첫 번째로 퀄리티 지표를 계산해줍니다. 코드는 앞에서 살펴본 것과 거의 비슷하며, 자기자본이익률, 매출총이익, 영업활동현금흐름을 계산해줍니다. 그 후 <code>mutate_all()</code> 함수를 통해 랭킹을 구한 후 다시 표준화하며, 내림차순으로 정리하기 위해 랭킹 부분에 <code>desc()</code>를 붙여줍니다.</p>
<p><code>rowSums()</code> 함수를 통해 계산된 Z-Score를 종목별로 합쳐줍니다. Z-Score의 히스토그램을 살펴보면 이상치가 없이 중앙에 데이터가 많이 분포되어 있습니다.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-1"></a>factor_value =<span class="st"> </span>KOR_value <span class="op">%&gt;%</span></span>
<span id="cb384-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-2"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">min_rank</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb384-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-3"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">scale</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb384-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-4"></a><span class="st">  </span><span class="kw">rowSums</span>()</span>
<span id="cb384-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-5"></a></span>
<span id="cb384-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-6"></a>factor_value <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb384-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-7"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb384-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">.</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb384-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb384-9"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-20-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>두 번째로 밸류 지표를 계산해줍니다. 밸류 지표는 이미 테이블 형태로 들어와 있으며, 랭킹과 표준화를 거쳐 합을 구해줍니다. 역시나 이상치가 없이 중앙에 데이터가 많이 분포되어 있습니다.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-1"></a><span class="kw">library</span>(PerformanceAnalytics)</span>
<span id="cb385-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb385-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-3"></a></span>
<span id="cb385-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-4"></a>ret_3m =<span class="st"> </span><span class="kw">Return.calculate</span>(KOR_price) <span class="op">%&gt;%</span><span class="st"> </span>xts<span class="op">::</span><span class="kw">last</span>(<span class="dv">60</span>) <span class="op">%&gt;%</span></span>
<span id="cb385-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-5"></a><span class="st">  </span><span class="kw">sapply</span>(., <span class="cf">function</span>(x) {<span class="kw">prod</span>(<span class="dv">1</span><span class="op">+</span>x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>})</span>
<span id="cb385-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-6"></a>ret_6m =<span class="st"> </span><span class="kw">Return.calculate</span>(KOR_price) <span class="op">%&gt;%</span><span class="st"> </span>xts<span class="op">::</span><span class="kw">last</span>(<span class="dv">120</span>) <span class="op">%&gt;%</span></span>
<span id="cb385-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-7"></a><span class="st">  </span><span class="kw">sapply</span>(., <span class="cf">function</span>(x) {<span class="kw">prod</span>(<span class="dv">1</span><span class="op">+</span>x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>})</span>
<span id="cb385-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-8"></a>ret_12m =<span class="st"> </span><span class="kw">Return.calculate</span>(KOR_price) <span class="op">%&gt;%</span><span class="st"> </span>xts<span class="op">::</span><span class="kw">last</span>(<span class="dv">252</span>) <span class="op">%&gt;%</span></span>
<span id="cb385-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-9"></a><span class="st">  </span><span class="kw">sapply</span>(., <span class="cf">function</span>(x) {<span class="kw">prod</span>(<span class="dv">1</span><span class="op">+</span>x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>})</span>
<span id="cb385-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-10"></a>ret_bind =<span class="st"> </span><span class="kw">cbind</span>(ret_3m, ret_6m, ret_12m) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>()</span>
<span id="cb385-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-11"></a></span>
<span id="cb385-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-12"></a>factor_mom =<span class="st"> </span>ret_bind <span class="op">%&gt;%</span></span>
<span id="cb385-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-13"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">min_rank</span>(<span class="kw">desc</span>(.)))) <span class="op">%&gt;%</span></span>
<span id="cb385-14"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-14"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">scale</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb385-15"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-15"></a><span class="st">  </span><span class="kw">rowSums</span>()</span>
<span id="cb385-16"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-16"></a></span>
<span id="cb385-17"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-17"></a>factor_mom <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb385-18"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-18"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb385-19"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-19"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">.</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb385-20"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb385-20"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-21-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>마지막으로 모멘텀 지표를 계산해줍니다. 최근 60일, 120일, 252일 주가를 통해 3개월, 6개월, 12개월 수익률을 구해준 후 <code>cbind()</code> 함수를 통해 열로 묶어줍니다. 그 후 내림차순 기준 랭킹과 표준화를 거쳐 합을 구합니다.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-1"></a><span class="kw">library</span>(corrplot)</span>
<span id="cb386-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-2"></a></span>
<span id="cb386-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-3"></a><span class="kw">cbind</span>(factor_quality, factor_value, factor_mom) <span class="op">%&gt;%</span></span>
<span id="cb386-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb386-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-5"></a><span class="st">  </span><span class="kw">setNames</span>(<span class="kw">c</span>(<span class="st">&#39;Quality&#39;</span>, <span class="st">&#39;Value&#39;</span>, <span class="st">&#39;Momentum&#39;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb386-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-6"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&#39;complete.obs&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb386-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-7"></a><span class="st">  </span><span class="kw">round</span>(., <span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb386-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-8"></a><span class="st">  </span><span class="kw">corrplot</span>(<span class="dt">method =</span> <span class="st">&#39;color&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;upper&#39;</span>,</span>
<span id="cb386-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-9"></a>           <span class="dt">addCoef.col =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">number.cex =</span> <span class="dv">1</span>,</span>
<span id="cb386-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-10"></a>           <span class="dt">tl.cex =</span> <span class="fl">0.6</span>, <span class="dt">tl.srt =</span> <span class="dv">45</span>, <span class="dt">tl.col =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb386-11"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-11"></a>           <span class="dt">col =</span></span>
<span id="cb386-12"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-12"></a>             <span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;white&#39;</span>, <span class="st">&#39;red&#39;</span>))(<span class="dv">200</span>),</span>
<span id="cb386-13"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb386-13"></a>           <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>퀄리티, 밸류, 모멘텀 팩터 간의 랭크의 서로 간 상관관계가 매우 낮으며, 여러 팩터를 동시에 고려함으로서 분산효과를 기대할 수 있습니다.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-1"></a>factor_qvm =</span>
<span id="cb387-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-2"></a><span class="st">  </span><span class="kw">cbind</span>(factor_quality, factor_value, factor_mom) <span class="op">%&gt;%</span></span>
<span id="cb387-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb387-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-4"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">list</span>(<span class="op">~</span><span class="kw">scale</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb387-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">factor_quality =</span> factor_quality <span class="op">*</span><span class="st"> </span><span class="fl">0.33</span>,</span>
<span id="cb387-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-6"></a>         <span class="dt">factor_value =</span> factor_value <span class="op">*</span><span class="st"> </span><span class="fl">0.33</span>,</span>
<span id="cb387-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-7"></a>         <span class="dt">factor_mom =</span> factor_mom <span class="op">*</span><span class="st"> </span><span class="fl">0.33</span>) <span class="op">%&gt;%</span></span>
<span id="cb387-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-8"></a><span class="st">  </span><span class="kw">rowSums</span>()</span>
<span id="cb387-9"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-9"></a></span>
<span id="cb387-10"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb387-10"></a>invest_qvm =<span class="st"> </span><span class="kw">rank</span>(factor_qvm) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span></span></code></pre></div>
<p>계산된 팩터들을 토대로 최종 포트폴리오를 구성해보겠습니다. 각 팩터의 분포가 역시나 다르기 때문에 다시 한번 <code>scale()</code> 함수를 통해 정규화해주며, 각 팩터에 동일한 비중인 0.33을 곱한 후 이를 더합니다.</p>
<p>물론 팩터별 비중을 [0.2, 0.4, 0.4]와 같이 다르게 줄 수도 있으며, 이는 어떠한 팩터를 더욱 중요하게 생각하는지 혹은 더욱 좋게 보는지에 따라 조정이 가능합니다.</p>
<p>최종적으로 해당 값의 랭킹 기준 상위 30종목을 선택합니다.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb388-1"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb388-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb388-2"></a></span>
<span id="cb388-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb388-3"></a>quality_profit[invest_qvm, ] <span class="op">%&gt;%</span></span>
<span id="cb388-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb388-4"></a><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></span>
<span id="cb388-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb388-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb388-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb388-6"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb388-7"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb388-7"></a><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>key, <span class="dt">scale =</span> <span class="st">&#39;free&#39;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb388-8"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb388-8"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>먼저 선택된 종목의 퀄리티 지표별 분포를 살펴보겠습니다. 대부분 종목의 수익성이 높음이 확인됩니다.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb389-1"></a>KOR_value[invest_qvm, ] <span class="op">%&gt;%</span></span>
<span id="cb389-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb389-2"></a><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></span>
<span id="cb389-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb389-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb389-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb389-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb389-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb389-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>key, <span class="dt">scale =</span> <span class="st">&#39;free&#39;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb389-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb389-6"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-25-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이번에는 선택된 종목의 가치지표별 분포입니다. 대부분 종목의 값이 낮아 밸류 종목임이 확인됩니다.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb390-1"></a>ret_bind[invest_qvm, ] <span class="op">%&gt;%</span></span>
<span id="cb390-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb390-2"></a><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></span>
<span id="cb390-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb390-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb390-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb390-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb390-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb390-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>key, <span class="dt">scale =</span> <span class="st">&#39;free&#39;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb390-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb390-6"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="10-factor_adv_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>마지막으로 각 종목들의 기간별 수익률 분포입니다. 역시나 대부분의 종목들이 높은 수익률을 보입니다.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb391-1"></a>KOR_ticker[invest_qvm, ] <span class="op">%&gt;%</span></span>
<span id="cb391-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb391-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">&#39;종목코드&#39;</span>, <span class="st">&#39;종목명&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb391-3"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb391-3"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">round</span>(quality_roe[invest_qvm, ], <span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb391-4"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb391-4"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">round</span>(KOR_value<span class="op">$</span>PBR[invest_qvm], <span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb391-5"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb391-5"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">round</span>(ret_12m[invest_qvm], <span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb391-6"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb391-6"></a><span class="st">  </span><span class="kw">setNames</span>(<span class="kw">c</span>(<span class="st">&#39;종목코드&#39;</span>, <span class="st">&#39;종목명&#39;</span>, <span class="st">&#39;ROE&#39;</span>, <span class="st">&#39;PBR&#39;</span>, <span class="st">&#39;12M&#39;</span>))</span></code></pre></div>
<pre><code>##      종목코드           종목명  ROE  PBR  12M
## 248    298020       효성티앤씨 0.16 1.86 0.74
## 257    097520         엠씨넥스 0.38 4.14 0.50
## 269    005880         대한해운 0.10 0.90 0.55
## 394    298000         효성화학 0.19 1.22 0.38
## 402    015750       성우하이텍 0.03 0.39 1.31
## 430    049070           인탑스 0.07 0.93 1.39
## 440    003070     코오롱글로벌 0.10 1.01 1.12
## 523    035890         서희건설 0.16 0.96 0.45
## 567    002310       아세아제지 0.10 0.60 0.30
## 614    123040     엠에스오토텍 0.08 1.47 0.39
## 648    001390         KG케미칼 0.07 0.23 1.11
## 685    016450 한세예스24홀딩스 0.03 0.48 0.06
## 750    036200           유니셈 0.18 2.25 1.06
## 835    089470        HDC현대EP 0.05 0.75 0.51
## 852    054210           이랜텍 0.07 1.27 0.48
## 880    104460   디와이피엔에프 0.31 3.02 0.69
## 888    023600         삼보판지 0.07 0.50 0.36
## 990    079960       동양이엔피 0.11 0.84 0.50
## 1002   013520     화승알앤에이 0.09 0.68 0.21
## 1028   083930           아바코 0.15 1.44 1.81
## 1332   053690       한미글로벌 0.18 0.95 0.19
## 1370   010100       한국프랜지 0.05 0.48 0.50
## 1379   002870         신풍제지 0.28 1.50 0.96
## 1400   078890       가온미디어 0.12 0.73 0.03
## 1476   126600           코프라 0.08 0.91 0.47
## 1478   002880       대유에이텍 0.04 0.41 0.30
## 1612   009180   한솔로지스틱스 0.13 1.76 0.65
## 1664   089850       유비벨록스 0.03 0.44 0.70
## 1918   037400         우리조명 0.01 0.35 0.97
## 1994   007530         영신금속 0.14 1.13 1.21</code></pre>
<p>포트폴리오 내 종목들을 대상으로 팩터별 대표적인 지표인 ROE, PBR, 12개월 수익률을 나타냈습니다. 전반적으로 ROE는 높고 PBR은 낮으며, 12개월 수익률이 높은 모습을 보입니다. 물론 특정 팩터의 강도가 약하더라도 나머지 팩터의 강도가 충분히 강하다면, 포트폴리오에 편입되는 모습을 보이기도 합니다.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb393-1"></a><span class="kw">cbind</span>(quality_profit, KOR_value, ret_bind)[invest_qvm, ] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb393-2"><a href="퀀트-전략을-이용한-종목선정-심화.html#cb393-2"></a><span class="st">  </span><span class="kw">apply</span>(., <span class="dv">2</span>, mean) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">t</span>()</span></code></pre></div>
<pre><code>##        ROE   GPA   CFO  PER   PBR   PCR   PSR ret_3m
## [1,] 0.119 0.207 0.113 11.4 1.121 4.172 0.407  0.577
##      ret_6m ret_12m
## [1,]  0.855   0.663</code></pre>
<p>마지막으로 포트폴리오 내 종목들의 지표별 평균을 계산한 값입니다.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-greenblatt2010little">
<p>Greenblatt, Joel. 2010. <em>The Little Book That Still Beats the Market</em>. Vol. 29. John Wiley &amp; Sons.</p>
</div>
<div id="ref-novy2013other">
<p>Novy-Marx, Robert. 2013. “The Other Side of Value: The Gross Profitability Premium.” <em>Journal of Financial Economics</em> 108 (1): 1–28.</p>
</div>
</div>
<div id="disqus_thread"></div>
<script>

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://quant-cookbook.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="퀀트-전략을-이용한-종목선정-기본.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="포트폴리오-구성.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"split_bib": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
